<form [formGroup]="form" (submit)="save()">
  <mat-card>
    <mat-card-header>
      <div mat-card-avatar>
        <mat-icon>picture_in_picture</mat-icon>
      </div>
      <mat-card-title>Tiled Text Part</mat-card-title>
    </mat-card-header>

    <mat-card-content>
      <!-- citation -->
      <div>
        <mat-form-field>
          <input matInput formControlName="citation" placeholder="citation" />
        </mat-form-field>
      </div>
      <!-- rows -->
      <div *ngIf="rows" cdkDropListGroup>
        <!-- row -->
        <div
          cdkDropList
          cdkDropListOrientation="horizontal"
          *ngFor="let row of rows; let i = index"
          (cdkDropListDropped)="drop($event, row)"
          fxLayout="row"
          fxLayoutAlign="start center"
        >
          <span class="row-nr">{{ i + 1 }}</span>
          <!-- tiles -->
          <cadmus-text-tile
            *ngFor="let tile of row.tiles || []"
            [tile]="tile"
            cdkDrag
            fxFlex="none"
            (click)="selectedTile=tile"
            [selected]="tile===selectedTile"
          >
          <div class="tile-placeholder" *cdkDragPlaceholder></div>
          </cadmus-text-tile>
          <button
            type="button"
            mat-icon-button
            (click)="addTile(row)"
            matTooltip="Append new tile"
          >
            <mat-icon>add_circle</mat-icon>
          </button>
        </div>
      </div>
      <button
        type="button"
        mat-icon-button
        matTooltip="Append new row"
        (click)="addRow()"
      >
        <mat-icon>add_circle</mat-icon>
      </button>

      <mat-card-actions>
        <cadmus-close-save-buttons
          [form]="form"
          [noSave]="isVisitor"
          (closeRequest)="close()"
        ></cadmus-close-save-buttons>
      </mat-card-actions>
    </mat-card-content>
  </mat-card>
</form>
